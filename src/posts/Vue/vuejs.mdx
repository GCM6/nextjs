---
title: 'Vue3原理笔记'
date: '2024-10-26'
---

## Vue3原理笔记

#### VueJS是一个声明式框架


__命令式和声明式__

> 视图层框架通常分为命令式和声明式

1) 命令式：jquery 就是比较典型的命令式框架，命令式框架一大特点就是关注过程

2) 声明式：声明式的框架于命令式的框架关注过程不同，声明式框架更加关注结果

__引出：vue是内部实现是通过命令式的，而暴露给到用户的却是声明式的__

_优缺点：
命令式的代码性能优于声明式的代码_


#### 模板的工作原理

```
模板通过编译器编译成渲染函数，当然无论是使用模板还是手写的渲染函数，对于一个组件来说它要渲染的内容最终都是渲染函数产生的，然后渲染器再把渲染函数返回的虚拟dom渲染成真实dom。
这就是模板的工作原理，也是vue渲染页面的流程。

编译器--> 渲染函数--> 虚拟dom--> 渲染器--> 真实dom
```
## 响应式：

#### Vue代理数组

* [源码数组方法重写](https://github1s.com/vuejs/core/blob/main/packages/reactivity/src/arrayInstrumentations.ts)

* 数组本身也是一个对象，它跟普通对象的区别是数组对象部署的内部方法[[DefineOwnProperty]]。在执行数组对象的内部方法的[[Set]]时候，[[Set]]是依赖于[[DefineOwnProperty]]的。
* 数组的方法如includes方法为了找到给定的值它内部会访问数组的length属性以及数组的索引，但是我们知道监听数组的响应式是监听数组的length属性。
* 数组的方法如push方法，在push的时候会触发2次依赖收集，一次是length的读取一次是push的，这是个问题，所以需要我们在get中把一次给取消了，这就需要重写数组方法设置一个状态了。

#### 代理Set和Map;

* ```Set```和```Map```这2个数据类型的操作方法相似，最大的不同是```Set```是通过add添加元素而```Map```是通过set添加元素。
* [Set.prototype.set是一个属性访问器](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set/size)。
